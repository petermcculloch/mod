{
	"patcher" : 	{
		"fileversion" : 1,
		"appversion" : 		{
			"major" : 7,
			"minor" : 2,
			"revision" : 0,
			"architecture" : "x86",
			"modernui" : 1
		}
,
		"rect" : [ 84.0, 154.0, 888.0, 608.0 ],
		"editing_bgcolor" : [ 0.9, 0.9, 0.9, 1.0 ],
		"bglocked" : 0,
		"openinpresentation" : 0,
		"default_fontsize" : 12.0,
		"default_fontface" : 0,
		"default_fontname" : "Arial",
		"gridonopen" : 1,
		"gridsize" : [ 15.0, 15.0 ],
		"gridsnaponopen" : 1,
		"objectsnaponopen" : 1,
		"statusbarvisible" : 2,
		"toolbarvisible" : 1,
		"lefttoolbarpinned" : 0,
		"toptoolbarpinned" : 0,
		"righttoolbarpinned" : 0,
		"bottomtoolbarpinned" : 0,
		"toolbars_unpinned_last_save" : 0,
		"tallnewobj" : 0,
		"boxanimatetime" : 200,
		"enablehscroll" : 1,
		"enablevscroll" : 1,
		"devicewidth" : 0.0,
		"description" : "",
		"digest" : "",
		"tags" : "",
		"style" : "",
		"subpatcher_template" : "",
		"boxes" : [ 			{
				"box" : 				{
					"id" : "obj-8",
					"maxclass" : "newobj",
					"numinlets" : 0,
					"numoutlets" : 1,
					"outlettype" : [ "" ],
					"patching_rect" : [ 827.0, 27.0, 30.0, 22.0 ],
					"style" : "",
					"text" : "in 3"
				}

			}
, 			{
				"box" : 				{
					"id" : "obj-7",
					"maxclass" : "newobj",
					"numinlets" : 1,
					"numoutlets" : 0,
					"patching_rect" : [ 827.0, 583.0, 37.0, 22.0 ],
					"style" : "",
					"text" : "out 4"
				}

			}
, 			{
				"box" : 				{
					"id" : "obj-6",
					"maxclass" : "newobj",
					"numinlets" : 1,
					"numoutlets" : 0,
					"patching_rect" : [ 574.666687, 583.0, 37.0, 22.0 ],
					"style" : "",
					"text" : "out 3"
				}

			}
, 			{
				"box" : 				{
					"id" : "obj-3",
					"maxclass" : "newobj",
					"numinlets" : 1,
					"numoutlets" : 0,
					"patching_rect" : [ 322.333344, 583.0, 37.0, 22.0 ],
					"style" : "",
					"text" : "out 2"
				}

			}
, 			{
				"box" : 				{
					"code" : "// History dtheta1(0.); // Δtheta1\r\n// History dtheta2(0.); // Δtheta2\r\nHistory dTheta1(0.);// Δtheta1\r\nHistory dTheta2(0.);// Δtheta2\r\nHistory time(0.);\r\n\r\n// History dw1(0.); // ΔangularVelocity1\r\n// History dw2(0.); // ΔangularVelocity2\r\n// History w1(0.01); // Angular velocity of top rod\r\n// History w2(0.01); // Angular velocity of bottom rod\r\n\r\nHistory Theta1(0*pi*0.5);\r\nHistory Theta2(2.3*pi*0.5);\r\nHistory l1(1.);\r\nHistory l2(1.);\r\n\r\n// Variables for Range-Kutta\r\nHistory k11,k12,k13,k14,k21,k22,k23,k24,k31,k32,k33,k34,k41,k42,k43,k44;\r\nParam damp1(0.001);\r\nParam damp2(0.001);\r\nParam len1(1.);   // Length of top rod\r\nParam len2(1.);   // Length of bottom rod\r\n\r\n\r\nParam gravity(-9.81); // Acceleration\r\nParam m1(10.); // Mass 1\r\nParam m2(10.); // Mass 2\r\n\r\n\r\n\r\ng = gravity; // /samplerate;\r\n\r\n\r\ntime =  in1*1./samplerate;\r\n\r\nif (in2 != 0) {\r\n\tdTheta1 = clamp(dTheta1+in2,-samplerate,samplerate); // /samplerate;\r\n}\r\nif (in3 != 0) {\r\n\tdTheta2 = clamp(dTheta2+in3,-samplerate,samplerate); // /samplerate;\r\n}\r\n\r\n\r\nmu      =  1.+(m1/m2);\nd2Theta1  =  (g*(sin(Theta2)*cos(Theta1-Theta2)-mu*sin(Theta1))-(l2*dTheta2*dTheta2+l1*dTheta1*dTheta1*cos(Theta1-Theta2))*sin(Theta1-Theta2))/(l1*(mu-cos(Theta1-Theta2)*cos(Theta1-Theta2)));\nd2Theta2  =  (mu*g*(sin(Theta1)*cos(Theta1-Theta2)-sin(Theta2))+(mu*l1*dTheta1*dTheta1+l2*dTheta2*dTheta2*cos(Theta1-Theta2))*sin(Theta1-Theta2))/(l2*(mu-cos(Theta1-Theta2)*cos(Theta1-Theta2)));\ndTheta1   += d2Theta1*time;\ndTheta2   += d2Theta2*time;\r\ndTheta1 *= (1- damp1/samplerate);\r\ndTheta1 = clamp(dTheta1,-samplerate,samplerate);\r\n// dTheta2 *= (1-damp2/samplerate);\nTheta1    += dTheta1*time; // *(1-damp1);\nTheta2    += dTheta2*time; // *(1-damp2);\r\nTheta1 \t   = wrap(Theta1,0,twopi);\r\nTheta2     = wrap(Theta2,0,twopi);\r\n\r\n/*\r\ndt1 = w1;\r\n\r\ndt2 = w2;\r\n\r\ndw1 = ((-gravity*(2*mass1 + mass2)*sin(theta1)) \r\n\t  - (mass2 * gravity * sin(theta1-(2*theta2))) \r\n\t  - (2 * sin(theta1-theta2) * mass2 * (w2*w2*L2 + w1*w1*L1*cos(theta1-theta2)))) \r\n      / \r\n      (L1*(2*mass1 + mass2 - (mass2*cos(2*theta1-2*theta2)))); \r\n\r\ndw2 = ((2*sin(theta1-theta2))\r\n      * (w1*w1*L1*(mass1+mass2)\r\n\t  + (gravity*(mass1+mass2)*cos(theta1))\r\n\t  + (w2*w2*L2*mass2*cos(theta1-theta2))))\r\n\t  /\r\n\t  (L2 * (2*mass1 + mass2 - mass2*cos(2*theta1 - 2*theta2)));\r\n\t\r\ntheta1 += dt1;\r\ntheta2 += dt2;\r\nw1 += dw1;\r\nw2 += dw2;\r\n*/\r\n\r\n// X0+l1*Math.sin(Theta1), y: Y0+l1*Math.cos(Theta1)\r\nx1 = l1*sin(Theta1);\r\ny1 = l1*cos(Theta1);\r\nx2 = l1*sin(Theta1) + l2*sin(Theta2);\r\ny2 = l1*cos(Theta1) + l2*cos(Theta2);\r\nout1 = x1; // wrap(theta2,0,twopi) + in1*0;\r\nout2 = y1;\r\nout3 = x2;\r\nout4 = y2;\r\n\r\nl1 = mix(l1,len1,0.001);\r\nl2 = mix(l2,len2,0.001);\r\n",
					"fontface" : 0,
					"fontname" : "Arial",
					"fontsize" : 12.0,
					"id" : "obj-5",
					"maxclass" : "codebox",
					"numinlets" : 3,
					"numoutlets" : 4,
					"outlettype" : [ "", "", "", "" ],
					"patching_rect" : [ 70.0, 74.0, 776.0, 480.0 ],
					"style" : ""
				}

			}
, 			{
				"box" : 				{
					"id" : "obj-1",
					"maxclass" : "newobj",
					"numinlets" : 0,
					"numoutlets" : 1,
					"outlettype" : [ "" ],
					"patching_rect" : [ 70.0, 14.0, 170.0, 22.0 ],
					"style" : "",
					"text" : "in 1 @default 1. @min 0.0001"
				}

			}
, 			{
				"box" : 				{
					"id" : "obj-2",
					"maxclass" : "newobj",
					"numinlets" : 0,
					"numoutlets" : 1,
					"outlettype" : [ "" ],
					"patching_rect" : [ 448.5, 18.0, 30.0, 22.0 ],
					"style" : "",
					"text" : "in 2"
				}

			}
, 			{
				"box" : 				{
					"id" : "obj-4",
					"maxclass" : "newobj",
					"numinlets" : 1,
					"numoutlets" : 0,
					"patching_rect" : [ 70.0, 583.0, 37.0, 22.0 ],
					"style" : "",
					"text" : "out 1"
				}

			}
 ],
		"lines" : [ 			{
				"patchline" : 				{
					"destination" : [ "obj-5", 0 ],
					"disabled" : 0,
					"hidden" : 0,
					"source" : [ "obj-1", 0 ]
				}

			}
, 			{
				"patchline" : 				{
					"destination" : [ "obj-5", 1 ],
					"disabled" : 0,
					"hidden" : 0,
					"source" : [ "obj-2", 0 ]
				}

			}
, 			{
				"patchline" : 				{
					"destination" : [ "obj-3", 0 ],
					"disabled" : 0,
					"hidden" : 0,
					"source" : [ "obj-5", 1 ]
				}

			}
, 			{
				"patchline" : 				{
					"destination" : [ "obj-4", 0 ],
					"disabled" : 0,
					"hidden" : 0,
					"source" : [ "obj-5", 0 ]
				}

			}
, 			{
				"patchline" : 				{
					"destination" : [ "obj-6", 0 ],
					"disabled" : 0,
					"hidden" : 0,
					"source" : [ "obj-5", 2 ]
				}

			}
, 			{
				"patchline" : 				{
					"destination" : [ "obj-7", 0 ],
					"disabled" : 0,
					"hidden" : 0,
					"source" : [ "obj-5", 3 ]
				}

			}
, 			{
				"patchline" : 				{
					"destination" : [ "obj-5", 2 ],
					"disabled" : 0,
					"hidden" : 0,
					"source" : [ "obj-8", 0 ]
				}

			}
 ]
	}

}
